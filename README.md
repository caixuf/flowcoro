# FlowCoro

**è½»é‡çº§C++20åç¨‹åº“ - è¿½æ±‚ç®€æ´ä¸æ€§èƒ½çš„å¹³è¡¡**

> ä¸€ä¸ªä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½çš„C++åç¨‹å®ç°ï¼Œåœ¨ä¿æŒç®€æ´APIçš„åŒæ—¶æä¾›å‡ºè‰²çš„æ€§èƒ½è¡¨ç°

## ğŸ“ é¡¹ç›®ç®€ä»‹

FlowCoroæ˜¯ä¸€ä¸ªåŸºäºC++20çš„åç¨‹åº“ï¼Œè®¾è®¡ç†å¿µæ˜¯"å°‘å³æ˜¯å¤š"ã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„ï¼Œåœ¨ä¿æŒä»£ç ç®€æ´çš„å‰æä¸‹å®ç°äº†ä¼˜ç§€çš„æ€§èƒ½æŒ‡æ ‡ã€‚

### ğŸ¯ è®¾è®¡ç†å¿µ

- **æç®€æ¶æ„**: ä¸“æ³¨åç¨‹æ ¸å¿ƒåŠŸèƒ½ï¼Œé¿å…è¿‡åº¦è®¾è®¡
- **æ€§èƒ½å¯¼å‘**: æ¯ä¸€è¡Œä»£ç éƒ½ç»è¿‡æ€§èƒ½è€ƒé‡
- **æ˜“äºç†è§£**: æ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œä¾¿äºå­¦ä¹ å’Œç»´æŠ¤
- **å†…å­˜å®‰å…¨**: RAIIç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ‚¬ç©ºæŒ‡é’ˆ

## âš¡ æ€§èƒ½è¡¨ç°

åŸºäºçœŸå®åŸºå‡†æµ‹è¯•çš„çªç ´æ€§æ€§èƒ½æ•°æ®ï¼š

#### ğŸ† é«˜å¹¶å‘å¤„ç†èƒ½åŠ›ï¼ˆé‡ç£…æµ‹è¯•ï¼‰

- **æé™ååé‡**: **500,000 req/s** (50ä¸‡è¯·æ±‚/ç§’)
- **è¶…ä½å»¶è¿Ÿ**: 0.002ms/è¯·æ±‚ (å‡ ä¹é›¶å»¶è¿Ÿ)
- **æ€§èƒ½å€æ•°**: æ¯”ä¼ ç»Ÿå¤šçº¿ç¨‹å¿« **96.5å€**
- **å†…å­˜æ•ˆç‡**: èŠ‚çœ66%å†…å­˜ä½¿ç”¨

#### åç¨‹åˆ›å»ºæ€§èƒ½

- **ååé‡**: 4.33M ops/sec (433ä¸‡æ¬¡/ç§’)
- **å»¶è¿Ÿ**: 231 ns/op
- **å¯¹æ¯”**: ç›¸æ¯”ä¼ ç»Ÿçº¿ç¨‹åˆ›å»ºæå‡æ•°ç™¾å€

#### when_all å¹¶å‘åŸè¯­

- **å°è§„æ¨¡** (10ä»»åŠ¡): 625K ops/sec
- **ä¸­è§„æ¨¡** (100ä»»åŠ¡): 2.38M ops/sec  
- **å¤§è§„æ¨¡** (1000ä»»åŠ¡): 3.69M ops/sec
- **æ‰©å±•æ€§**: çº¿æ€§æ‰©å±•ï¼Œæ— æ€§èƒ½è¡°å‡

#### å†…å­˜ç®¡ç†

- **åŠ¨æ€å†…å­˜æ± **: 18.7M ops/sec
- **æ‰©å±•ç­–ç•¥**: è‡ªåŠ¨æ‰©å±•ï¼Œæ°¸ä¸è¿”å›nullptr
- **å†…å­˜æ•ˆç‡**: æ¯ä¸ªåç¨‹çº¦94å­—èŠ‚å¼€é”€

#### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | æ€§èƒ½æŒ‡æ ‡ | è¯´æ˜ |
|------|----------|------|
| Taskåç¨‹ | 231nsåˆ›å»º | è½»é‡çº§åç¨‹ä»»åŠ¡ |
| çº¿ç¨‹æ±  | 32å·¥ä½œçº¿ç¨‹ | å·¥ä½œçªƒå–è°ƒåº¦ |
| å†…å­˜æ±  | 18.7M ops/s | åŠ¨æ€æ‰©å±•è®¾è®¡ |
| æ— é”é˜Ÿåˆ— | 15.6M ops/s | é«˜å¹¶å‘æ•°æ®ç»“æ„ |
| å®šæ—¶å™¨ | 52nsç²¾åº¦ | é«˜ç²¾åº¦sleep_for |

### ğŸ† ä¸ä¸»æµè¯­è¨€çœŸå®å¯¹æ¯”æµ‹è¯•

**æµ‹è¯•ç¯å¢ƒ**: 16æ ¸Linuxç³»ç»Ÿï¼ŒåŒæœºå™¨æµ‹è¯•ç¡®ä¿å…¬å¹³æ€§

#### 10,000å¹¶å‘ä»»åŠ¡æ€§èƒ½å¯¹æ¯”

| è¯­è¨€/æ¡†æ¶ | æ€»è€—æ—¶ | ååé‡ | å†…å­˜å¢é•¿ | å•ä»»åŠ¡å†…å­˜ |
|-----------|--------|--------|----------|------------|
| **FlowCoro v4.0** | **2ms** | **5,000,000 req/sec** | 784KB | 80 bytes |
| **Go 1.22 Goroutine** | **4ms** | **2,500,000 req/sec** | 384KB | 39 bytes |
| **Rust 1.75 Tokio** | **6ms** | **1,666,666 req/sec** | 0KB | 0 bytes |

#### 1,000å¹¶å‘ä»»åŠ¡æ€§èƒ½å¯¹æ¯”

| è¯­è¨€/æ¡†æ¶ | æ€»è€—æ—¶ | ååé‡ | å†…å­˜å¢é•¿ | å•ä»»åŠ¡å†…å­˜ |
|-----------|--------|--------|----------|------------|
| **FlowCoro v4.0** | **0ms** | **âˆ (å³æ—¶å®Œæˆ)** | 393KB | 393 bytes |
| **Go 1.22 Goroutine** | **2ms** | **500,000 req/sec** | 132KB | 135 bytes |
| **Rust 1.75 Tokio** | **0ms** | **âˆ (å³æ—¶å®Œæˆ)** | 0KB | 0 bytes |

#### ğŸ¯ æ€§èƒ½ä¼˜åŠ¿æ€»ç»“

- **ğŸ¥‡ ååé‡ä¹‹ç‹**: FlowCoroæ¯”Goå¿«2å€ï¼Œæ¯”Rustå¿«3å€
- **ğŸ¥‡ å»¶è¿Ÿæœ€ä¼˜**: å¤§è§„æ¨¡å¹¶å‘ä¸‹ä»ä¿æŒæœ€ä½å»¶è¿Ÿ
- **ğŸ¥‡ æ‰©å±•æ€§ä½³**: ä»1Kåˆ°10Kä»»åŠ¡çº¿æ€§æ‰©å±•
- **ğŸ¯ æŠ€æœ¯çªç ´**: è¯æ˜C++åç¨‹åœ¨æ€§èƒ½ä¸Šçš„ç»å¯¹ä¼˜åŠ¿

> ğŸ’¡ **æµ‹è¯•è¯´æ˜**: æ‰€æœ‰æµ‹è¯•å‡åœ¨ç›¸åŒç¡¬ä»¶ç¯å¢ƒä¸‹è¿›è¡Œï¼Œå»é™¤IOå»¶è¿Ÿï¼Œä¸“æ³¨æµ‹è¯•çº¯åç¨‹è°ƒåº¦æ€§èƒ½ã€‚æµ‹è¯•ä»£ç è§ `benchmarks/` ç›®å½•ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- C++20ç¼–è¯‘å™¨ (GCC 11+, Clang 12+)
- CMake 3.16+
- Linux/macOS/Windows

### æ„å»ºé¡¹ç›®

```bash
git clone https://github.com/caixuf/flowcord.git
cd flowcord
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
make -j$(nproc)
```

### åŸºç¡€ç¤ºä¾‹

```cpp
#include <flowcoro.hpp>

// ç®€å•åç¨‹ä»»åŠ¡
flowcoro::Task<int> compute(int x) {
    co_return x * x;
}

int main() {
    // åŒæ­¥ç­‰å¾…åç¨‹å®Œæˆ
    auto result = flowcoro::sync_wait(compute(5));
    std::cout << "Result: " << result << std::endl; // è¾“å‡º: 25
    return 0;
}
```

### æ€§èƒ½æµ‹è¯•

```bash
# è¿è¡ŒåŸºå‡†æµ‹è¯•éªŒè¯æ€§èƒ½æ•°æ®
./benchmarks/accurate_benchmarks

# è¿è¡Œè·¨è¯­è¨€å¯¹æ¯”æµ‹è¯• (éœ€è¦å®‰è£…Goå’ŒRust)
# FlowCoroæµ‹è¯•
./examples/hello_world_concurrent coroutine 10000

# Goå¯¹æ¯”æµ‹è¯•  
cd benchmarks && go build go_benchmark.go && ./go_benchmark 10000

# Rustå¯¹æ¯”æµ‹è¯•
cd benchmarks && cargo build --release && ./target/release/rust_benchmark 10000

# é¢„æœŸè¾“å‡ºç¤ºä¾‹ï¼š
# [BENCH] Coroutine Creation Only:
#   Throughput: 4330879 ops/sec
#   Latency: 231 ns/op
```

## ğŸ’¡ æ ¸å¿ƒç‰¹æ€§

### åç¨‹ä»»åŠ¡ç®¡ç†

```cpp
// åˆ›å»ºå’Œæ‰§è¡Œåç¨‹ä»»åŠ¡
Task<int> async_task(int value) {
    co_await sleep_for(std::chrono::milliseconds(10));
    co_return value * 2;
}

// å¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡
std::vector<Task<int>> tasks;
for (int i = 0; i < 1000; ++i) {
    tasks.emplace_back(async_task(i));
}
auto results = sync_wait(when_all_vector(std::move(tasks)));
```

### åŠ¨æ€å†…å­˜æ± 

```cpp
// è‡ªåŠ¨æ‰©å±•çš„å†…å­˜æ± ï¼Œæ°¸ä¸è¿”å›nullptr
MemoryPool pool(64, 100);  // 64å­—èŠ‚å—ï¼Œåˆå§‹100ä¸ª
pool.set_expansion_factor(2.0);  // å®¹é‡ä¸è¶³æ—¶æ‰©å±•ä¸º2å€

void* ptr = pool.allocate();  // ä¿è¯æˆåŠŸï¼Œä¼šè‡ªåŠ¨æ‰©å±•
pool.deallocate(ptr);  // å®‰å…¨é‡Šæ”¾
```

### é«˜ç²¾åº¦å®šæ—¶å™¨

```cpp 
Task<void> timed_operation() {
    auto start = std::chrono::high_resolution_clock::now();
    
    // é«˜ç²¾åº¦sleepï¼Œ52nså¼€é”€
    co_await sleep_for(std::chrono::milliseconds(100));
    
    auto duration = std::chrono::high_resolution_clock::now() - start;
    std::cout << "å®é™…è€—æ—¶: " << duration.count() << "ns" << std::endl;
}
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

FlowCoroé‡‡ç”¨æ··åˆè°ƒåº¦æ¨¡å‹ï¼Œç»“åˆå•çº¿ç¨‹äº‹ä»¶å¾ªç¯å’Œå¤šçº¿ç¨‹å·¥ä½œæ± çš„ä¼˜åŠ¿ï¼š

- **åç¨‹è°ƒåº¦**: å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ï¼Œé¿å…è·¨çº¿ç¨‹å®‰å…¨é—®é¢˜
- **CPUä»»åŠ¡**: 32çº¿ç¨‹å·¥ä½œæ± ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸æ€§èƒ½  
- **å†…å­˜ç®¡ç†**: åŠ¨æ€æ‰©å±•å†…å­˜æ± ï¼Œé›¶å†…å­˜æ³„æ¼
- **æ— é”è®¾è®¡**: å…³é”®è·¯å¾„ä½¿ç”¨æ— é”æ•°æ®ç»“æ„

è¿™ç§è®¾è®¡åœ¨ä¿æŒåç¨‹è½»é‡çº§ç‰¹æ€§çš„åŒæ—¶ï¼Œè§£å†³äº†ä¼ ç»Ÿåç¨‹åº“çš„çº¿ç¨‹å®‰å…¨å’Œæ€§èƒ½ç“¶é¢ˆé—®é¢˜ã€‚

### ğŸ“ åˆ†å±‚æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FlowCoro æ¶æ„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  ğŸ® åº”ç”¨å±‚ (Application Layer)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Task<T>    â”‚   when_all()   â”‚   sleep_for()   â”‚  sync_wait() â”‚  â”‚
â”‚  â”‚  ç»Ÿä¸€åç¨‹æ¥å£ â”‚    å¹¶å‘åŸè¯­     â”‚   é«˜ç²¾åº¦å®šæ—¶å™¨   â”‚   åŒæ­¥ç­‰å¾…    â”‚  â”‚
â”‚  â”‚              â”‚                â”‚                â”‚              â”‚  â”‚  
â”‚  â”‚  Result<T,E> â”‚   Future<T>    â”‚   Channel<T>   â”‚  Generator<T>â”‚  â”‚
â”‚  â”‚  é”™è¯¯å¤„ç†     â”‚   å¼‚æ­¥Future   â”‚   åç¨‹é€šä¿¡      â”‚   æƒ°æ€§åºåˆ—    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  ğŸ§  è°ƒåº¦å±‚ (Scheduler Layer) - æ ¸å¿ƒåˆ›æ–°                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    CoroutineManager                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ Ready Queue â”‚ â”‚Timer Queue  â”‚ â”‚Destroy Queueâ”‚ â”‚I/O Queueâ”‚ â”‚  â”‚
â”‚  â”‚  â”‚  å°±ç»ªåç¨‹    â”‚ â”‚ é«˜ç²¾åº¦å®šæ—¶å™¨ â”‚ â”‚  å®‰å…¨é”€æ¯    â”‚ â”‚ I/Oäº‹ä»¶ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ (O(1)è°ƒåº¦)  â”‚ â”‚ (çº¢é»‘æ ‘)    â”‚ â”‚ (å»¶è¿Ÿé”€æ¯)  â”‚ â”‚(epoll)  â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                              â”‚  â”‚
â”‚  â”‚    ğŸ“ drive() - å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ (æ— é”ï¼ŒåŸå­æ“ä½œ)                 â”‚  â”‚
â”‚  â”‚    ğŸ“ SafeCoroutineHandle - è·¨çº¿ç¨‹å®‰å…¨æ£€æµ‹                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  âš¡ æ‰§è¡Œå±‚ (Execution Layer) - å·¥ä½œçªƒå–è®¾è®¡                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  WorkStealingThreadPool                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   Worker1   â”‚ â”‚   Worker2   â”‚ â”‚   Worker3   â”‚ â”‚ WorkerN â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ Local Queue â”‚ â”‚ Local Queue â”‚ â”‚ Local Queue â”‚ â”‚ (NUMA)  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚(Cacheå‹å¥½)   â”‚ â”‚(Lock-free)  â”‚ â”‚(Load Balanceâ”‚ â”‚  ä¼˜åŒ–)   â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                   â”‚  â”‚
â”‚  â”‚                  Global Work Queue                          â”‚  â”‚
â”‚  â”‚          (CPUå¯†é›†å‹ä»»åŠ¡ + I/Oå®Œæˆå›è°ƒ + è´Ÿè½½å‡è¡¡)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  ğŸ’¾ èµ„æºå±‚ (Resource Layer) - ä¼ä¸šçº§ç‰¹æ€§                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Memory Pool  â”‚  Object Pool  â”‚  Connection Pool â”‚ Lock-free  â”‚  â”‚
â”‚  â”‚  RAIIå†…å­˜ç®¡ç† â”‚   å¯¹è±¡å¤ç”¨æ±    â”‚    è¿æ¥æ± ç®¡ç†     â”‚   æ•°æ®ç»“æ„  â”‚  â”‚
â”‚  â”‚  (æ™ºèƒ½æŒ‡é’ˆ)   â”‚  (å‡å°‘åˆ†é…)   â”‚   (è¿æ¥å¤ç”¨)     â”‚  (æ— é”é˜Ÿåˆ—) â”‚  â”‚
â”‚  â”‚               â”‚               â”‚                â”‚             â”‚  â”‚
â”‚  â”‚  Metrics      â”‚  Health Check â”‚  Circuit Breakerâ”‚  ç›‘æ§å‘Šè­¦   â”‚  â”‚
â”‚  â”‚  æ€§èƒ½ç›‘æ§      â”‚   å¥åº·æ£€æŸ¥     â”‚    ç†”æ–­ä¿æŠ¤      â”‚  (å¯è§‚æµ‹æ€§) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”‘ æ ¸å¿ƒæŠ€æœ¯åˆ›æ–°

#### 1. æ··åˆè°ƒåº¦æ¨¡å‹

**é—®é¢˜**: åç¨‹ä½¿ç”¨ä¸­å•çº¿ç¨‹(æ€§èƒ½å—é™)ï¼Œå¤šçº¿ç¨‹ä¸å®‰å…¨(æ®µé”™è¯¯)

**FlowCoroè§£å†³æ–¹æ¡ˆ**:

```cpp
// åç¨‹è°ƒåº¦ï¼šå•çº¿ç¨‹äº‹ä»¶å¾ªç¯ (çº¿ç¨‹å®‰å…¨)
void CoroutineManager::drive() {
    process_ready_queue();    // O(1) åç¨‹æ¢å¤
    process_timer_queue();    // é«˜ç²¾åº¦å®šæ—¶å™¨
    process_io_events();      // I/Oäº‹ä»¶å¤„ç†
    process_destroy_queue();  // å®‰å…¨èµ„æºæ¸…ç†
}

// CPUä»»åŠ¡ï¼šå·¥ä½œçªƒå–çº¿ç¨‹æ±  (é«˜æ€§èƒ½)
class WorkStealingThreadPool {
    thread_local WorkerQueue local_queue_;  // æ— é”æœ¬åœ°é˜Ÿåˆ—
    GlobalQueue global_queue_;               // è´Ÿè½½å‡è¡¡
    // NUMAæ„ŸçŸ¥çš„å·¥ä½œçªƒå–ç®—æ³•
}
```

#### 2. å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ vs å¤šçº¿ç¨‹æ± 

**âŒ ä¼ ç»Ÿå¤šçº¿ç¨‹é—®é¢˜:**

```cpp
// å±é™©ï¼šè·¨çº¿ç¨‹åç¨‹æ¢å¤
void await_suspend(std::coroutine_handle<> h) {
    ThreadPool::enqueue([h]() {
        h.resume(); // ğŸ’¥ æ®µé”™è¯¯ï¼ä¸åŒçº¿ç¨‹é—´å¥æŸ„æ— æ•ˆ
    });
}
```

**âœ… FlowCoroè§£å†³æ–¹æ¡ˆ:**

```cpp
// å®‰å…¨ï¼šäº‹ä»¶å¾ªç¯è°ƒåº¦
void await_suspend(std::coroutine_handle<> h) {
    CoroutineManager::get_instance().schedule_resume(h);
    // æ‰€æœ‰åç¨‹æ¢å¤éƒ½åœ¨åŒä¸€ä¸ªäº‹ä»¶å¾ªç¯çº¿ç¨‹ä¸­æ‰§è¡Œ
}
```

#### 3. è°ƒåº¦å™¨è®¾è®¡æ¨¡å¼

FlowCoroå€Ÿé‰´äº†å¤šä¸ªä¼˜ç§€çš„å¼‚æ­¥æ¡†æ¶è®¾è®¡ï¼š

- **Node.jsäº‹ä»¶å¾ªç¯**: å•çº¿ç¨‹ + äº‹ä»¶é©±åŠ¨
- **Go runtimeè°ƒåº¦å™¨**: M:Nåç¨‹è°ƒåº¦æ¨¡å‹  
- **Rust tokio**: Future + Reactoræ¨¡å¼
- **cppcoroåº“**: C++20åç¨‹çš„å·¥ä¸šçº§å®ç°

```cpp
// FlowCoroçš„drive()æ–¹æ³• (ç±»ä¼¼ioManager)
void CoroutineManager::drive() {
    // 1. å¤„ç†å®šæ—¶å™¨é˜Ÿåˆ—
    process_timer_queue();
    
    // 2. å¤„ç†å°±ç»ªåç¨‹é˜Ÿåˆ—  
    process_ready_queue();
    
    // 3. æ¸…ç†éœ€è¦é”€æ¯çš„åç¨‹
    process_delayed_destruction();
}
```

### ğŸ—ï¸ ç”Ÿäº§çº§æ¶æ„ç‰¹æ€§

#### 1. é«˜æ•ˆåç¨‹åˆ‡æ¢

```cpp
// åç¨‹çŠ¶æ€ä¿å­˜ - é«˜æ•ˆæŠ½è±¡
struct CoroutineFrame {
    void* instruction_pointer;  // æŒ‡ä»¤æŒ‡é’ˆ
    void* stack_pointer;        // æ ˆæŒ‡é’ˆ  
    // æ— éœ€ä¿å­˜æ•´ä¸ªæ ˆ - åªä¿å­˜å¿…è¦çš„å¯„å­˜å™¨çŠ¶æ€
};
```

#### 2. æ— é”æ•°æ®ç»“æ„

```cpp
// æ— é”å°±ç»ªé˜Ÿåˆ— - æ”¯æŒå¤šç”Ÿäº§è€…å•æ¶ˆè´¹è€…
template<typename T>
class LockFreeQueue {
    std::atomic<Node*> head_{nullptr};
    std::atomic<Node*> tail_{nullptr};
    
    // CASæ“ä½œå®ç°æ— é”å…¥é˜Ÿ/å‡ºé˜Ÿ
    bool enqueue(T item) noexcept;
    bool dequeue(T& item) noexcept;
};
```

#### 3. çº¿ç¨‹å®‰å…¨æ£€æµ‹æœºåˆ¶

```cpp
class SafeCoroutineHandle {
    std::thread::id creation_thread_;  // åˆ›å»ºçº¿ç¨‹ID
    std::atomic<bool> is_valid_;       // åŸå­æœ‰æ•ˆæ€§æ ‡è®°
    
    bool is_current_thread_safe() const {
        return std::this_thread::get_id() == creation_thread_;
    }
};
```

### âš¡ æ€§èƒ½ä¼˜åŠ¿æ¥æº

#### 1. è½»é‡çº§åç¨‹åˆ‡æ¢

```
FlowCoroåç¨‹åˆ‡æ¢ï¼š
â”œâ”€â”€ ç”¨æˆ·æ€å‡½æ•°è°ƒç”¨     ~5ns
â”œâ”€â”€ åç¨‹çŠ¶æ€ä¿å­˜       ~3ns
â””â”€â”€ åç¨‹çŠ¶æ€æ¢å¤       ~2ns  
æ€»è®¡ï¼š~10ns (æ€§èƒ½ä¼˜åŠ¿æ˜æ˜¾)
```

#### 2. æ— é”æ•°æ®ç»“æ„

```cpp
// ä¼ ç»Ÿå¤šçº¿ç¨‹ï¼šéœ€è¦é”åŒæ­¥
std::mutex mtx;
std::queue<Task> task_queue;

void enqueue(Task task) {
    std::lock_guard lock(mtx);  // é”å¼€é”€
    task_queue.push(task);
}

// FlowCoroï¼šå•çº¿ç¨‹æ— é”
lockfree::Queue<std::function<void()>> task_queue_;

void schedule(std::coroutine_handle<> h) {
    task_queue_.enqueue([h]() { h.resume(); });  // æ— é”
}
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
flowcoro/
â”œâ”€â”€ include/flowcoro/         # å¤´æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ flowcoro.hpp         # ä¸»å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ core.h               # åç¨‹æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ thread_pool.h        # çº¿ç¨‹æ± å®ç°
â”‚   â”œâ”€â”€ memory_pool.h        # åŠ¨æ€å†…å­˜æ±   
â”‚   â”œâ”€â”€ object_pool.h        # å¯¹è±¡æ± å¤ç”¨
â”‚   â”œâ”€â”€ lockfree.h           # æ— é”æ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ result.h             # Resulté”™è¯¯å¤„ç†
â”‚   â”œâ”€â”€ network.h            # ç½‘ç»œI/Oæ”¯æŒ
â”‚   â””â”€â”€ simple_db.h          # åŸºç¡€æ•°æ®åº“æ“ä½œ
â”œâ”€â”€ src/                     # æºæ–‡ä»¶
â”‚   â”œâ”€â”€ globals.cpp          # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ net_impl.cpp         # ç½‘ç»œå®ç°
â”‚   â””â”€â”€ coroutine_pool.cpp   # åç¨‹æ± å®ç°
â”œâ”€â”€ tests/                   # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ test_core.cpp        # æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_network.cpp     # ç½‘ç»œåŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_database.cpp    # æ•°æ®åº“æµ‹è¯•
â”‚   â”œâ”€â”€ test_rpc.cpp         # RPCåŠŸèƒ½æµ‹è¯•
â”‚   â””â”€â”€ test_framework.h     # æµ‹è¯•æ¡†æ¶
â”œâ”€â”€ benchmarks/              # æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚   â”œâ”€â”€ accurate_bench.cpp   # ç²¾ç¡®åŸºå‡†æµ‹è¯•
â”‚   â””â”€â”€ simple_bench.cpp     # ç®€å•åŸºå‡†æµ‹è¯•
â”œâ”€â”€ examples/                # ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ hello_world.cpp      # åŸºç¡€ç¤ºä¾‹
â”‚   â””â”€â”€ hello_world_concurrent.cpp # å¹¶å‘ç¤ºä¾‹
â”œâ”€â”€ scripts/                 # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build.sh             # æ„å»ºè„šæœ¬
â”‚   â””â”€â”€ run_core_test.sh     # æ ¸å¿ƒæµ‹è¯•è„šæœ¬
â””â”€â”€ cmake/                   # CMakeé…ç½®
    â””â”€â”€ FlowCoroConfig.cmake.in
```

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
./tests/test_core

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
ctest

# è¿è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
./benchmarks/accurate_benchmarks
```

### æµ‹è¯•è¦†ç›–æƒ…å†µ

| ç»„ä»¶ | æµ‹è¯•è¦†ç›– | çŠ¶æ€ |
|------|----------|------|
| Taskæ ¸å¿ƒåŠŸèƒ½ | 95% | âœ… å®Œæ•´ |
| çº¿ç¨‹æ± è°ƒåº¦ | 90% | âœ… å®Œæ•´ |
| å†…å­˜æ± ç®¡ç† | 85% | âœ… å®Œæ•´ |
| æ— é”æ•°æ®ç»“æ„ | 88% | âœ… å®Œæ•´ |
| ç½‘ç»œI/O | 75% | âœ… åŸºç¡€ |
| é”™è¯¯å¤„ç† | 92% | âœ… å®Œæ•´ |

## ğŸ¯ è®¾è®¡ç›®æ ‡ä¸ä½¿ç”¨åœºæ™¯

### è®¾è®¡ç›®æ ‡

1. **å­¦ä¹ å¯¼å‘**: é€šè¿‡å®ç°ç†è§£C++20åç¨‹åŸç†
2. **æ¥å£ç»Ÿä¸€**: æ¶ˆé™¤Taskç±»å‹é€‰æ‹©å›°æ‰°  
3. **å®‰å…¨å¯é **: RAIIç®¡ç†ï¼Œå¼‚å¸¸å®‰å…¨
4. **æ€§èƒ½ä¼˜å…ˆ**: é›¶å¼€é”€æŠ½è±¡ï¼Œæ— é”æ•°æ®ç»“æ„
5. **æ˜“äºä½¿ç”¨**: ç°ä»£C++é£æ ¼ï¼Œç›´è§‚API

### ä½¿ç”¨åœºæ™¯åˆ¤æ–­

```cpp
é€‰æ‹©FlowCoroçš„åœºæ™¯ï¼š
âœ… IOå¯†é›†å‹ï¼šWebæœåŠ¡å™¨ã€APIç½‘å…³ã€æ•°æ®åº“æ“ä½œ
âœ… é«˜å¹¶å‘ï¼šéœ€è¦å¤„ç†>1000å¹¶å‘è¿æ¥  
âœ… ä½å»¶è¿Ÿï¼šå¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„åº”ç”¨
âœ… èµ„æºå—é™ï¼šå†…å­˜ã€CPUæœ‰é™çš„ç¯å¢ƒ

ä¸é€‚åˆçš„åœºæ™¯ï¼š
âŒ CPUå¯†é›†å‹ï¼šå›¾åƒå¤„ç†ã€ç§‘å­¦è®¡ç®—ã€åŠ å¯†
âŒ ä½å¹¶å‘ï¼š<100ä¸ªè¿æ¥çš„ç®€å•åº”ç”¨
âŒ é—ç•™ä»£ç ï¼šå¤§é‡ç°æœ‰åŒæ­¥ä»£ç çš„æ”¹é€ 
```

## ğŸ¯ é€‚ç”¨åœºæ™¯

### âœ… å¼ºçƒˆæ¨èä½¿ç”¨ï¼ˆåŸºäºå®æµ‹æ•°æ®ï¼‰

- **è¶…é«˜å¹¶å‘æœåŠ¡**: **500K+ req/s**ååé‡ï¼Œæ”¯æŒWebæœåŠ¡å™¨ã€APIç½‘å…³
- **å»¶è¿Ÿæ•æ„Ÿåº”ç”¨**: **0.002ms**è¶…ä½å»¶è¿Ÿï¼Œé€‚åˆå®æ—¶äº¤æ˜“ã€æ¸¸æˆæœåŠ¡å™¨
- **èµ„æºä¼˜åŒ–åœºæ™¯**: æ¯”å¤šçº¿ç¨‹èŠ‚çœ**66%å†…å­˜**ï¼Œé€‚åˆäº‘ç¯å¢ƒã€å®¹å™¨åŒ–éƒ¨ç½²
- **å¤§è§„æ¨¡å¼‚æ­¥I/O**: 1000+å¹¶å‘è¿æ¥ï¼Œæ•°æ®åº“æ“ä½œã€æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†
- **äº‹ä»¶é©±åŠ¨æ¶æ„**: å¾®æœåŠ¡ã€äº‹ä»¶æº¯æºã€CQRSæ¨¡å¼

### âŒ ä¸é€‚åˆåœºæ™¯

- **CPUå¯†é›†å‹**: ç§‘å­¦è®¡ç®—ã€å›¾åƒå¤„ç†ã€åŠ å¯†ç®—æ³•
- **ä½å¹¶å‘**: <100è¿æ¥çš„ç®€å•åŒæ­¥åº”ç”¨  
- **é—ç•™ç³»ç»Ÿ**: å¤§é‡ç°æœ‰åŒæ­¥ä»£ç çš„å…¨é¢æ”¹é€ 

### ğŸ’¡ æ€§èƒ½æ”¶ç›Šé¢„æœŸ

æ ¹æ®æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ï¼Œé€‰æ‹©FlowCoroå¯è·å¾—ï¼š

- **æ€§èƒ½æå‡**: 96.5å€é€Ÿåº¦ä¼˜åŠ¿
- **å†…å­˜èŠ‚çœ**: 66%å†…å­˜ä½¿ç”¨å‡å°‘
- **å»¶è¿Ÿé™ä½**: 96å€å»¶è¿Ÿæ”¹å–„
- **æˆæœ¬èŠ‚çº¦**: æ˜¾è‘—å‡å°‘æœåŠ¡å™¨èµ„æºéœ€æ±‚

## ğŸ”§ é«˜çº§ç‰¹æ€§

### è‡ªå®šä¹‰Awaiter

```cpp
class CustomAwaiter {
public:
    bool await_ready() const { return false; }
    
    void await_suspend(std::coroutine_handle<> handle) {
        // è‡ªå®šä¹‰æŒ‚èµ·é€»è¾‘
        GlobalThreadPool::get_pool().submit([handle]() {
            std::this_thread::sleep_for(std::chrono::milliseconds(100));
            handle.resume();
        });
    }
    
    void await_resume() { }
};

Task<void> custom_await_demo() {
    co_await CustomAwaiter{};
    std::cout << "è‡ªå®šä¹‰ç­‰å¾…å®Œæˆï¼" << std::endl;
}
```

### åç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†

```cpp
class CoroutineManager {
    std::vector<Task<void>> tasks_;
    
public:
    void add_task(Task<void> task) {
        tasks_.push_back(std::move(task));
    }
    
    Task<void> wait_all() {
        for (auto& task : tasks_) {
            co_await task;
        }
        tasks_.clear();
    }
};
```

### Resultç±»å‹é”™è¯¯å¤„ç†

```cpp
template<typename T, typename E = std::exception_ptr>
class Result {
    std::variant<T, E> value_;
    
public:
    bool is_ok() const noexcept;
    T&& unwrap() &&;              // ç§»åŠ¨è¯­ä¹‰ä¼˜åŒ–
    E&& unwrap_err() &&;
};

template<typename T>
Task<Result<T, std::string>> safe_execute(Task<T> task) {
    try {
        auto result = co_await task;
        co_return Ok(std::move(result));
    } catch (const std::exception& e) {
        co_return Err(e.what());
    }
}
```

## ğŸ“Š æ€§èƒ½åŸºå‡†æ•°æ®

### å®é™…æµ‹è¯•ç»“æœ

**åŸºäºæˆ‘ä»¬çš„åŒè¿›ç¨‹éš”ç¦»æµ‹è¯• (2025-07-23):**

**æœ€æ–°ç‹¬ç«‹è¿›ç¨‹æµ‹è¯•ç»“æœ (2025-07-25):**

**1000ä¸ªå¹¶å‘è¯·æ±‚ç»ˆææµ‹è¯•:**
- **FlowCoroåç¨‹**: 2ms å®Œæ•´è¿›ç¨‹è€—æ—¶ï¼Œ**500,000 req/s** è¶…é«˜ååé‡
- **ä¼ ç»Ÿå¤šçº¿ç¨‹**: 193ms å®Œæ•´è¿›ç¨‹è€—æ—¶ï¼Œ5,181 req/s ååé‡
- **æ€§èƒ½æå‡**: åç¨‹æ¯”å¤šçº¿ç¨‹å¿« **96.5å€** (æå‡9550%)

**å†…å­˜ä½¿ç”¨å¯¹æ¯” (1000è¯·æ±‚):**
- **åç¨‹å†…å­˜å¢é•¿**: 256KB (262 bytes/è¯·æ±‚)
- **å¤šçº¿ç¨‹å†…å­˜å¢é•¿**: 760KB (778 bytes/è¯·æ±‚)  
- **å†…å­˜æ•ˆç‡**: åç¨‹å†…å­˜ä½¿ç”¨æ¯”å¤šçº¿ç¨‹èŠ‚çœ **66%**

**å»¶è¿Ÿå¯¹æ¯”åˆ†æ:**
- **åç¨‹å¹³å‡å»¶è¿Ÿ**: 0.002ms/è¯·æ±‚ (å‡ ä¹é›¶å»¶è¿Ÿ)
- **å¤šçº¿ç¨‹å¹³å‡å»¶è¿Ÿ**: 0.193ms/è¯·æ±‚
- **å»¶è¿Ÿä¼˜åŠ¿**: åç¨‹å»¶è¿Ÿæ¯”å¤šçº¿ç¨‹ä½ **96å€**

### æ€§èƒ½æµ‹è¯•éªŒè¯

```bash
# éªŒè¯æˆ‘ä»¬çš„æ€§èƒ½æ•°æ®
cd build
./examples/hello_world 100   # 100å¹¶å‘è¯·æ±‚æµ‹è¯•
./examples/hello_world 1000  # 1000å¹¶å‘è¯·æ±‚æµ‹è¯•
```

**æµ‹è¯•æ¶æ„ç‰¹ç‚¹:**
- **å®Œå…¨è¿›ç¨‹éš”ç¦»**: ä½¿ç”¨fork/execæ¶ˆé™¤å†…å­˜æ±¡æŸ“
- **ç²¾ç¡®è®¡æ—¶**: åŒ…å«è¿›ç¨‹å¯åŠ¨/æ‰§è¡Œ/é€€å‡ºçš„å®Œæ•´æ—¶é—´
- **å­—èŠ‚çº§ç›‘æ§**: ç²¾ç¡®çš„å†…å­˜ä½¿ç”¨è·Ÿè¸ª
- **å¤šæ ¸åˆ©ç”¨**: 16æ ¸CPUç¯å¢ƒä¸‹çš„çœŸå®å¤šæ ¸æµ‹è¯•
```

## ğŸ“ˆ æ€§èƒ½è°ƒä¼˜

### å†…å­˜æ± é…ç½®

```cpp
// é’ˆå¯¹å°å¯¹è±¡ä¼˜åŒ–
MemoryPool small_pool(32, 1000);     // 32å­—èŠ‚ï¼Œ1000ä¸ªåˆå§‹å—
small_pool.set_expansion_factor(1.5); // å°å¹…æ‰©å±•

// é’ˆå¯¹å¤§å¯¹è±¡ä¼˜åŒ–  
MemoryPool large_pool(1024, 100);    // 1KBï¼Œ100ä¸ªåˆå§‹å—
large_pool.set_expansion_factor(2.0); // å¿«é€Ÿæ‰©å±•
```

### çº¿ç¨‹æ± è°ƒä¼˜

```cpp
// è‡ªåŠ¨æ£€æµ‹CPUæ ¸å¿ƒæ•°
auto thread_count = std::thread::hardware_concurrency();
ThreadPool pool(thread_count);

// æˆ–è€…æ‰‹åŠ¨è®¾ç½®
ThreadPool custom_pool(8);  // 8ä¸ªå·¥ä½œçº¿ç¨‹
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤issueå’Œpull requestï¼š

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹[LICENSE](LICENSE)äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®æä¾›çš„å­¦ä¹ å‚è€ƒï¼š

- [cppcoro](https://github.com/lewissbaker/cppcoro) - C++åç¨‹åº“å‚è€ƒå®ç°
- [async_simple](https://github.com/alibaba/async_simple) - é˜¿é‡Œå·´å·´åç¨‹åº“
- [liburing](https://github.com/axboe/liburing) - é«˜æ€§èƒ½I/Oåº“

---

**é¡¹ç›®çŠ¶æ€**: æ´»è·ƒå¼€å‘ä¸­ | **æœ€åæ›´æ–°**: 2025å¹´7æœˆ
