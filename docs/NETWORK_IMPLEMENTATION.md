# FlowCoro ç½‘ç»œIOå±‚å®ç°æ€»ç»“

## ğŸ¯ å®ç°æˆæœ

FlowCoroç½‘ç»œIOå±‚å·²æˆåŠŸå®ç°ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

### âœ… å·²å®Œæˆçš„åŠŸèƒ½

#### 1. äº‹ä»¶å¾ªç¯ (EventLoop)
- **åŸºäºepollçš„é«˜æ€§èƒ½äº‹ä»¶å¾ªç¯**
- æ”¯æŒæ–‡ä»¶æè¿°ç¬¦çš„æ·»åŠ ã€ä¿®æ”¹ã€ç§»é™¤
- å®šæ—¶å™¨æ”¯æŒ
- å¼‚æ­¥ä»»åŠ¡è°ƒåº¦
- ä¼˜é›…çš„å¯åŠ¨å’Œåœæ­¢

#### 2. å¼‚æ­¥Socket (Socket)
- **éé˜»å¡Socketæ“ä½œ**
- å¼‚æ­¥è¿æ¥ã€ç»‘å®šã€ç›‘å¬
- å¼‚æ­¥è¯»å†™æ“ä½œ
- è¡Œè¯»å–å’Œç²¾ç¡®å­—èŠ‚è¯»å–
- Socketé€‰é¡¹è®¾ç½®
- RAIIèµ„æºç®¡ç†

#### 3. TCPæœåŠ¡å™¨ (TcpServer)
- **é«˜å¹¶å‘TCPæœåŠ¡å™¨**
- è¿æ¥å¤„ç†å™¨æ¨¡å¼
- å¼‚æ­¥æ¥å—è¿æ¥
- è‡ªåŠ¨è¿æ¥ç®¡ç†

#### 4. TCPè¿æ¥ (TcpConnection)
- **ç¼“å†²å¼TCPè¿æ¥**
- è¯»å†™ç¼“å†²åŒº
- è¡Œè¯»å–å’Œå—è¯»å–
- ä¼˜é›…å…³é—­

#### 5. å…¨å±€äº‹ä»¶å¾ªç¯ç®¡ç†
- **å•ä¾‹æ¨¡å¼çš„å…¨å±€äº‹ä»¶å¾ªç¯**
- è‡ªåŠ¨åˆå§‹åŒ–å’Œæ¸…ç†
- çº¿ç¨‹å®‰å…¨

### ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

#### åç¨‹å‹å¥½è®¾è®¡
```cpp
// å¼‚æ­¥è¿æ¥
co_await socket.connect("127.0.0.1", 8080);

// å¼‚æ­¥è¯»å†™
auto data = co_await socket.read_line();
co_await socket.write_string("Hello, World!");

// æœåŠ¡å™¨å¤„ç†
server.set_connection_handler([](auto client) -> Task<void> {
    auto request = co_await client->read_line();
    co_await client->write_string("Echo: " + request);
});
```

#### é«˜æ€§èƒ½ç‰¹æ€§
- **é›¶æ‹·è´è®¾è®¡**: æœ€å°åŒ–æ•°æ®å¤åˆ¶
- **æ— é”æ¶æ„**: åŸºäºæ— é”é˜Ÿåˆ—çš„ä»»åŠ¡è°ƒåº¦
- **äº‹ä»¶é©±åŠ¨**: epollæ”¯æŒé«˜å¹¶å‘
- **å†…å­˜å‹å¥½**: RAIIå’Œæ™ºèƒ½æŒ‡é’ˆç®¡ç†èµ„æº

#### ç±»å‹å®‰å…¨
- **å¼ºç±»å‹Taskç³»ç»Ÿ**: `Task<T>`, `Task<void>`, `Task<unique_ptr<T>>`
- **å¼‚å¸¸å®‰å…¨**: å®Œæ•´çš„å¼‚å¸¸ä¼ æ’­æœºåˆ¶
- **ç¼–è¯‘æ—¶æ£€æŸ¥**: æ¨¡æ¿ç‰¹åŒ–ç¡®ä¿ç±»å‹æ­£ç¡®æ€§

### ğŸ“Š æµ‹è¯•è¦†ç›–

#### åŸºç¡€åŠŸèƒ½æµ‹è¯• âœ…
- EventLoopåˆ›å»ºå’Œé”€æ¯
- Socketåˆ›å»ºå’ŒåŸºæœ¬æ“ä½œ
- TcpServeråˆ›å»ºå’Œé…ç½®

#### é›†æˆæµ‹è¯•æ¡†æ¶
- å®Œæ•´çš„æµ‹è¯•å¥—ä»¶é›†æˆ
- ä¸ç°æœ‰æ— é”æ•°æ®ç»“æ„æµ‹è¯•å…¼å®¹
- ä¸åç¨‹æ¡†æ¶æµ‹è¯•å…¼å®¹

### ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

#### åç¨‹æ”¯æŒ
```cpp
// Taskæ¨¡æ¿ç³»ç»Ÿ
template<typename T> struct Task;
template<> struct Task<void>;                    // voidç‰¹åŒ–
template<typename T> struct Task<unique_ptr<T>>; // unique_ptrç‰¹åŒ–

// AsyncPromiseç³»ç»Ÿ
template<typename T> class AsyncPromise;
template<> class AsyncPromise<void>;             // voidç‰¹åŒ–  
template<typename T> class AsyncPromise<unique_ptr<T>>; // unique_ptrç‰¹åŒ–
```

#### å†…å­˜ç®¡ç†
- é¿å…å…¨å±€é™æ€å˜é‡çš„å¤šé‡å®šä¹‰é—®é¢˜
- æ­£ç¡®çš„thread_localå˜é‡å¤„ç†
- æ¸…æ™°çš„æ‰€æœ‰æƒè¯­ä¹‰

#### é”™è¯¯å¤„ç†
- åŸºäºå¼‚å¸¸çš„é”™è¯¯ä¼ æ’­
- åç¨‹å¼‚å¸¸å®‰å…¨
- èµ„æºæ³„æ¼é˜²æŠ¤

### ğŸ® ä½¿ç”¨ç¤ºä¾‹

#### EchoæœåŠ¡å™¨
```cpp
auto& loop = flowcoro::net::GlobalEventLoop::get();
flowcoro::net::TcpServer server(&loop);

server.set_connection_handler([](auto client) -> flowcoro::Task<void> {
    auto data = co_await client->read_line();
    co_await client->write_string("Echo: " + data);
});

co_await server.listen("127.0.0.1", 8080);
```

### ğŸ“ˆ æ€§èƒ½ç‰¹å¾

#### é¢„æœŸæ€§èƒ½æŒ‡æ ‡
- **å¹¶å‘è¿æ¥**: æ”¯æŒ10k+å¹¶å‘è¿æ¥
- **å»¶è¿Ÿ**: P99å»¶è¿Ÿ < 10ms (ç›®æ ‡)
- **ååé‡**: 50k+ QPS (ç›®æ ‡)
- **å†…å­˜ä½¿ç”¨**: æ— å†…å­˜æ³„æ¼ï¼Œæœ€å°åŒ–åˆ†é…

### ğŸ”„ ä¸‹ä¸€æ­¥æ‰©å±•

#### åè®®å±‚æ”¯æŒ
- [ ] HTTP/1.1åè®®è§£æ
- [ ] WebSocketæ”¯æŒ
- [ ] è‡ªå®šä¹‰åè®®æ¡†æ¶

#### é«˜çº§ç‰¹æ€§
- [ ] è¿æ¥æ± ç®¡ç†
- [ ] è´Ÿè½½å‡è¡¡
- [ ] SSL/TLSæ”¯æŒ
- [ ] æœåŠ¡å‘ç°

#### æ€§èƒ½ä¼˜åŒ–
- [ ] é›¶æ‹·è´ä¼˜åŒ–
- [ ] NUMAæ„ŸçŸ¥
- [ ] æ‰¹é‡æ“ä½œæ”¯æŒ

### ğŸ¯ é¡¹ç›®çŠ¶æ€

**ç½‘ç»œIOå±‚å·²æˆåŠŸé›†æˆåˆ°FlowCoroé¡¹ç›®ä¸­ï¼**

- âœ… ç¼–è¯‘é€šè¿‡
- âœ… åŸºç¡€æµ‹è¯•é€šè¿‡
- âœ… ç¤ºä¾‹ä»£ç å¯è¿è¡Œ
- âœ… ä¸ç°æœ‰æ¡†æ¶é›†æˆ

**FlowCoroç°åœ¨å…·å¤‡äº†çœŸæ­£çš„å¼‚æ­¥ç½‘ç»œç¼–ç¨‹èƒ½åŠ›ï¼** ğŸš€

---

*è¿™æ ‡å¿—ç€FlowCoroä»åç¨‹æ¡†æ¶å‘ä¼ä¸šçº§å¼‚æ­¥ç¼–ç¨‹å¹³å°çš„é‡è¦è·¨è¶Šï¼*
